<?xml version="1.0" encoding="utf-8"?><Project ToolsVersion="4.0" DefaultTargets="Publish" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">	<PropertyGroup>			<!-- Input parameters -->		<PatchNumber></PatchNumber>		<TestNumber></TestNumber>		<SequenceNumber></SequenceNumber>		<CodeBaseDir></CodeBaseDir>		<StageToSQA></StageToSQA>			<ReleaseName>TeleReader</ReleaseName>					<ProjectName>TeleReader</ProjectName>		<TempFolder>\temp</TempFolder>				<BuildCompressed>true</BuildCompressed>			<PaddedPatchNumber>$(PatchNumber)</PaddedPatchNumber>		<PaddedPatchNumber Condition="$(PatchNumber) &lt; 100">0$(PatchNumber)</PaddedPatchNumber>		<PaddedPatchNumber Condition="$(PatchNumber) &lt; 10">00$(PatchNumber)</PaddedPatchNumber>		<!-- PatchFolderName>V3.0p$(PaddedPatchNumber)Sequence$(SequenceNumber)</PatchFolderName -->		<PatchFolderName>P$(PatchNumber)-T$(TestNumber)-S$(SequenceNumber)</PatchFolderName>			<!-- Specfic defined parameters for Build-4 server -->		<BDK32Dir Condition="'$(COMPUTERNAME)'=='isw-imgxpvmbld4'">C:\Program Files\Vista\BDK32</BDK32Dir>		<AccuSoftPackageDir Condition="'$(COMPUTERNAME)'=='isw-imgxpvmbld4'">C:\Program Files\AccuSoft\ImageGear v16\MD\ActiveX\Samples\Delphi2007\Package</AccuSoftPackageDir>		<DelphiFilmanexDir Condition="'$(COMPUTERNAME)'=='isw-imgxpvmbld4'">C:\Documents and Settings\All Users\Documents\RAD Studio\5.0\Demos\DelphiWin32\VCLWin32\Doc\Filmanex</DelphiFilmanexDir>		<VCLZip_Pro Condition="'$(COMPUTERNAME)'=='isw-imgxpvmbld4'">C:\VCLZip_Pro</VCLZip_Pro>							<MSBuildInstallShieldDir Condition="'$(COMPUTERNAME)'=='isw-imgxpvmbld4'">C:\Program Files\MSBuild\InstallShield\2012Spring</MSBuildInstallShieldDir>		<InstallShieldPath Condition="'$(COMPUTERNAME)'=='isw-imgxpvmbld4'">C:\Program Files\InstallShield\2012Spring\System</InstallShieldPath>				<NetworkBuildDir Condition="'$(COMPUTERNAME)'=='isw-imgxpvmbld4'">\\W2k8-stvi-sqa\Release\ReadyToTest\Patch$(PatchNumber)</NetworkBuildDir>		<MS_SDK_Dir Condition="'$(COMPUTERNAME)'=='isw-imgxpvmbld4'">C:\Program Files\Microsoft SDKs\Windows\v7.0A</MS_SDK_Dir>			<!-- ================================================= -->									<!-- Specfic defined parameters for Build-5 server -->						<BDK32Dir Condition="'$(COMPUTERNAME)'=='VAAUSVIMAPP872'">C:\Program Files (x86)\Vista\BDK32</BDK32Dir>		<AccuSoftPackageDir Condition="'$(COMPUTERNAME)'=='VAAUSVIMAPP872'">C:\Program Files (x86)\AccuSoft\ImageGear v16\MD\ActiveX\Samples\Delphi2007\Package</AccuSoftPackageDir>		<DelphiFilmanexDir Condition="'$(COMPUTERNAME)'=='VAAUSVIMAPP872'">C:\Users\Public\Documents\RAD Studio\5.0\Demos\DelphiWin32\VCLWin32\Doc\Filmanex</DelphiFilmanexDir>		<VCLZip_Pro Condition="'$(COMPUTERNAME)'=='VAAUSVIMAPP872'">E:\BuildLib\VCLZip_Pro_4.60</VCLZip_Pro>				<MSBuildInstallShieldDir Condition="'$(COMPUTERNAME)'=='VAAUSVIMAPP872'">C:\Program Files (x86)\MSBuild\InstallShield\2012Spring</MSBuildInstallShieldDir>		<InstallShieldPath Condition="'$(COMPUTERNAME)'=='VAAUSVIMAPP872'">C:\Program Files (x86)\InstallShield\2012Spring\System</InstallShieldPath>		<NetworkBuildDir Condition="'$(COMPUTERNAME)'=='VAAUSVIMAPP872'">\\vaausvimapp804.aac.dva.va.gov\CM\ReadyToTest\Patch$(PatchNumber)</NetworkBuildDir>		<MS_SDK_Dir Condition="'$(COMPUTERNAME)'=='VAAUSVIMAPP872'">C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A</MS_SDK_Dir>					<MSBuildExtensionsPath Condition="'$(COMPUTERNAME)'=='VAAUSVIMAPP872'">$(MSBuildExtensionsPath64)</MSBuildExtensionsPath>			<!-- ================================================= -->													<ReleaseDir>$(CodeBaseDir)\Release</ReleaseDir>		<BuildDir>$(CodeBaseDir)\Builds</BuildDir>				<OutputDir>$(BuildDir)\$(ProjectName)</OutputDir>			<FullBuildPath>$(OutputDir)\$(PatchFolderName)</FullBuildPath>																<ToolsDir>$(CodeBaseDir)\IMAG_Build\Tools</ToolsDir>		<NonVisaCfgDir>$(CodeBaseDir)\IMAG_Build\Configuration\NonVisaConfig</NonVisaCfgDir>		<ClinicalDir>$(CodeBaseDir)\IMAG_Source\Clinical</ClinicalDir>				<ReleaseClinDir>$(CodeBaseDir)\IMAG_Build\Release\Clin</ReleaseClinDir>		<GWHomeDir>$(CodeBaseDir)\IMAG_Build\LegacyVSS\GW</GWHomeDir>				<P106LibAccusoftHome>$(GWHomeDir)\3rd Party Source\Accusoft\Accusoft16.2</P106LibAccusoftHome>		<P72LibHome>$(GWHomeDir)\3rd Party Source\Accusoft\Accusoft15</P72LibHome>										<ProductVersion Condition="'$(ProductVersionInclude)'!='false'">30.$(SequenceNumber).$(PatchNumber).$(TestNumber)</ProductVersion>								<InstallShieldProject>$(FullBuildPath)$(TempFolder)\p$(PatchNumber)\Build\$(ProjectName)\MagTeleReaderInstall.ism</InstallShieldProject>								<ExeFileName>MAG3_0P$(PatchNumber)T$(TestNumber)_$(ReleaseName)_Setup.exe</ExeFileName>		<MsiFileName>MAG3_0P$(PatchNumber)T$(TestNumber)_$(ReleaseName)_Install.msi</MsiFileName>			</PropertyGroup>		<ItemGroup>		<ResVerEditorDirectory Include="$(ToolsDir)\ResVerEditor" />		<ReleaseToCopy Include="$(ReleaseClinDir)\**\*.*" />		<P72Lib Include="$(P72LibHome)\**\*.*" />		<P106LibAccusoft Include="$(P106LibAccusoftHome)\**\*.*" />		</ItemGroup>	<!-- ============================================================================  -->		<Import Project="$(MSBuildInstallShieldDir)\InstallShield.targets" />		<Import Project="$(MSBuildExtensionsPath)\MSBuildCommunityTasks\MSBuild.Community.Tasks.Targets"/>	<Import Project="$(MSBuildExtensionsPath)\ExtensionPack\4.0\MSBuild.ExtensionPack.tasks" /> 	<Import Project="$(NonVisaCfgDir)\Common\build.VistAImaging.xml"/>			<Import Project="$(ClinicalDir)\Delphi\Applications\Build\$(ProjectName)\build.$(ProjectName).prop"/>	<!-- =============================================================================== -->	<!-- =============================================================================== -->		<!-- Delete previous build -->	<Target Name="CleanPreviousBuild" >		<RemoveDir Directories="$(FullBuildPath)" Condition="Exists('$(FullBuildPath)')" />		<RemoveDir Directories="$(ReleaseDir)" Condition="Exists('$(ReleaseDir)')" /> 		</Target>				<!-- =============================================================================== -->	<!-- =============================================================================== -->		<!-- Create build ouput directories -->	<Target Name="CreateDirectories" DependsOnTargets="CleanPreviousBuild" >		<MakeDir directories="$(FullBuildPath)$(TempFolder)" />		<MakeDir directories="$(FullBuildPath)$(TempFolder)\P106Lib\System" />					</Target>	<!-- =============================================================================== -->	<!-- =============================================================================== -->				<!-- Copy files from source control over to build output directory -->	<Target Name="CopyFiles"  DependsOnTargets="CreateDirectories" >		<Copy SourceFiles="@(P106LibAccusoft)" DestinationFiles="@(P106LibAccusoft->'$(FullBuildPath)$(TempFolder)\P106Lib\LIB\Accusoft16.2\%(RecursiveDir)%(Filename)%(Extension)')" />		<Copy SourceFiles="@(P72Lib)" DestinationFiles="@(P72Lib->'$(FullBuildPath)$(TempFolder)\P72 Lib\%(RecursiveDir)%(Filename)%(Extension)')" />							<Copy SourceFiles="@(ReleaseToCopy)" DestinationFiles="@(ReleaseToCopy->'$(ReleaseDir)\%(RecursiveDir)%(Filename)%(Extension)')" />		<Copy SourceFiles="@(PatchDepName)" DestinationFiles="@(PatchDepName->'$(FullBuildPath)$(TempFolder)\p$(PatchNumber)\%(Folder)\%(RecursiveDir)%(Filename)%(Extension)')" />		</Target>			<!-- =============================================================================== -->	<!-- =============================================================================== -->				<Target Name="UpdateVersion" DependsOnTargets="CopyFiles" Outputs="%(DelphiFiles.Filename)">		<PropertyGroup>				<ResDir>%(ResVerEditorDirectory.FullPath)</ResDir>		</PropertyGroup>				<message text="Updating File Version number for %(DelphiFiles.Filename).res" Importance="High"/>		<Exec Command='"$(ResDir)\ResVerEditor.exe" -u %(DelphiFiles.Filename).res $(ProductVersion)' WorkingDirectory="%(DelphiFiles.RelativeDir)" ContinueOnError="false" />	</Target>		<!-- =============================================================================== -->	<!-- =============================================================================== -->			<!-- Compile Delphi projects -->	<Target Name="Compile" DependsOnTargets="UpdateVersion" Outputs="%(DelphiFiles.Filename)">		<message text="Compiling %(DelphiFiles.Filename)%(DelphiFiles.Extension) with compiler %(DelphiFiles.Compiler)" Importance="High"/>		<MSBuild Projects="%(DelphiFiles.Identity)" Targets="%(DelphiFiles.Options)" Properties="Configuration=%(DelphiFiles.Configuration)" Condition="'%(DelphiFiles.Compiler)'=='MSBuild'AND '%(DelphiFiles.ProjectOverride)'!='true'" /> 		<MSBuild Projects="%(DelphiFiles.Identity)"			Condition="'%(DelphiFiles.Compiler)'=='MSBuild' AND '%(DelphiFiles.ProjectOverride)'=='true'"			Targets="%(DelphiFiles.Options)" 			Properties="Configuration=%(DelphiFiles.Configuration);						DCC_DcuOutput=%(DelphiFiles.DCC_DcuOutput);						DCC_ObjOutput=%(DelphiFiles.DCC_ObjOutput);						DCC_HppOutput=%(DelphiFiles.DCC_HppOutput);						DCC_UnitSearchPath=%(DelphiFiles.DCC_UnitSearchPath);						DCC_ResourcePath=%(DelphiFiles.DCC_ResourcePath);						DCC_ObjPath=%(DelphiFiles.DCC_ObjPath);						DCC_IncludePath=%(DelphiFiles.DCC_IncludePath)" />				<!-- Exec Condition="'%(DelphiFiles.Compiler)'=='Delphi7'" Command='"$(DelphiHome)bin\Dcc32.exe" %(DelphiFiles.Filename)%(DelphiFiles.Extension) -N"$(FullBuildPath)$(TempFolder)\p$(PatchNumber)\Clin\dcu\TeleReader" -U"$(FullBuildPath)$(TempFolder)\p$(PatchNumber)\Clin\dcu\TeleReader;$(FullBuildPath)$(TempFolder)\p$(PatchNumber)\Clin\MAGFMDC;$(FullBuildPath)$(TempFolder)\p$(PatchNumber)\Clin\TeleReaderAdmin;$(FullBuildPath)$(TempFolder)\p$(PatchNumber)\Clin\Shared;$(DelphiHome)Projects\Bpl"' WorkingDirectory="%(DelphiFiles.RelativeDir)" ContinueOnError="false" / -->				<message text="Performing code signing of %(DelphiFiles.Filename).%(DelphiFiles.Sign)" />		<Exec Command='"$(MS_SDK_Dir)\bin\signtool.exe"  sign /a %(DelphiFiles.Filename).%(DelphiFiles.Sign)' WorkingDirectory="%(DelphiFiles.RelativeDir)" ContinueOnError="true" />	</Target>		<!-- =============================================================================== -->	<!-- =============================================================================== -->	<!-- Generate Product and Package code for InstallShield -->	<Target Name="UpdateISM" DependsOnTargets="Compile" >		<CallTarget Targets="GenerateProductCode" />	<!-- from ...\Common\buil.VistAImaging.xml -->		<CallTarget Targets="GeneratePackageCode" />	<!-- from ...\Common\buil.VistAImaging.xml -->	</Target>			<!-- =============================================================================== -->	<!-- =============================================================================== -->		<!-- Copy artifacts to release folder  -->	<Target Name="CopyArtifacts" DependsOnTargets="UpdateISM" >		<Copy SourceFiles="$(FullBuildPath)$(TempFolder)\p$(PatchNumber)\MiniBld\MagMiniBld.exe" DestinationFiles="$(ReleaseDir)\Utils\MagMiniBld.exe" ContinueOnError="False"/>		<Copy SourceFiles="$(FullBuildPath)$(TempFolder)\p$(PatchNumber)\MiniBld\MagLauncher.exe" DestinationFiles="$(ReleaseDir)\Utils\MagLauncher.exe" ContinueOnError="False"/>				<Copy SourceFiles="$(FullBuildPath)$(TempFolder)\p$(PatchNumber)\TeleReader\MAGTeleReaderMAIN.exe" DestinationFiles="$(ReleaseDir)\MAGTeleReader.exe" ContinueOnError="False"/>		</Target>				<!-- =============================================================================== -->	<!-- =============================================================================== -->	<!-- Create exe and/or msi file -->	<Target Name="BuildRelease" DependsOnTargets="CopyArtifacts" >		<CallTarget Targets="CreateInstaller" />	<!-- from ...\Common\buil.VistAImaging.xml -->	</Target>		<!-- =============================================================================== -->	<!-- =============================================================================== -->		<Target Name="StageToSQA" >			<MakeDir Directories="$(NetworkBuildDir)" Condition="!Exists('$(NetworkBuildDir)')" />		<Delete Files="$(NetworkBuildDir)\$(ExeFileName)" Condition="!Exists('$(NetworkBuildDir)\$(ExeFileName)')" />		<Delete Files="$(NetworkBuildDir)\$(MsiFileName)" Condition="!Exists('$(NetworkBuildDir)\$(MsiFileName)')" />		<Copy SourceFiles="$(FullBuildPath)\$(ExeFileName)" Destinationfolder="$(NetworkBuildDir)"/>		<Copy SourceFiles="$(FullBuildPath)\$(MsiFileName)" Destinationfolder="$(NetworkBuildDir)"/>		</Target>		<!-- =============================================================================== -->	<!-- =============================================================================== -->			<Target Name="Publish" DependsOnTargets="BuildRelease" Condition="'$(BuildTeleReaderAdmin)'!='false'"  >		<Copy SourceFiles="$(FullBuildPath)$(TempFolder)\p$(PatchNumber)\Build\$(ProjectName)\Express\MagInstall-exe\DiskImages\DISK1\setup.exe" DestinationFiles="$(FullBuildPath)\$(ExeFileName)" Condition="'$(CreateExe)'!='false'"/>			<Copy SourceFiles="$(FullBuildPath)$(TempFolder)\p$(PatchNumber)\Build\$(ProjectName)\Express\MagInstall-msi\DiskImages\DISK1\VistA Imaging Telereader.msi" DestinationFiles="$(FullBuildPath)\$(MsiFileName)" Condition="'$(CreateMsi)'!='false'" />			 		<CallTarget Targets="StageToSQA"  Condition="'$(StageToSQA)'=='True'" />  </Target>      	<!-- =============================================================================== -->	<!-- =============================================================================== -->			<Target Name="Compile_TEST" Outputs="%(DelphiFiles.Filename)">		<message text="TEST: Compiling %(DelphiFiles.Filename)%(DelphiFiles.Extension) with compiler %(DelphiFiles.Compiler)" Importance="High"/>		<MSBuild Projects="%(DelphiFiles.Identity)" Targets="%(DelphiFiles.Options)" Properties="Configuration=%(DelphiFiles.Configuration)" Condition="'%(DelphiFiles.Compiler)'=='MSBuild'AND '%(DelphiFiles.ProjectOverride)'!='true'" /> 		<MSBuild Projects="%(DelphiFiles.Identity)"			Condition="'%(DelphiFiles.Compiler)'=='MSBuild' AND '%(DelphiFiles.ProjectOverride)'=='true'"			Targets="%(DelphiFiles.Options)" 			Properties="Configuration=%(DelphiFiles.Configuration);						DCC_DcuOutput=%(DelphiFiles.DCC_DcuOutput);						DCC_ObjOutput=%(DelphiFiles.DCC_ObjOutput);						DCC_HppOutput=%(DelphiFiles.DCC_HppOutput);						DCC_UnitSearchPath=%(DelphiFiles.DCC_UnitSearchPath);						DCC_ResourcePath=%(DelphiFiles.DCC_ResourcePath);						DCC_ObjPath=%(DelphiFiles.DCC_ObjPath);						DCC_IncludePath=%(DelphiFiles.DCC_IncludePath)" />	</Target>	</Project>